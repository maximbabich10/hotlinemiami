# 🤖 CIAN Telegram Bot - Автоматическая рассылка сообщений

> **✅ ОБНОВЛЕНО:** Проект полностью переписан на JavaScript (Node.js) + Telegram бот!
> 
> Старые Python файлы удалены. Используйте новую версию: `telegram-bot.js` + `cian-mailer.js`

---

## 🚀 Быстрый старт

### 1. Установка Node.js 18+
- Скачайте с [nodejs.org](https://nodejs.org/)
- macOS: `brew install node`

### 2. Установка зависимостей
```bash
npm install
```

### 3. Создание Telegram бота
1. Найдите [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте `/newbot` и следуйте инструкциям
3. Сохраните токен бота

### 4. Настройка `.env`
Скопируйте `env.example` в `.env` (или используйте `config.env`):
```env
CIAN_EMAIL=your_email@mail.ru
CIAN_PASSWORD=your_password
TELEGRAM_BOT_TOKEN=ваш_токен_от_BotFather
TELEGRAM_ADMIN_ID=ваш_telegram_id
```

Получить ваш Telegram ID: [@userinfobot](https://t.me/userinfobot)

### 5. Запуск
```bash
npm run dev
# или
npm start
```

### 6. Использование
1. Откройте бота в Telegram
2. Отправьте `/start`
3. Нажмите **"▶️ Запустить рассылку"**

---

## ✨ Возможности

- ✅ **Управление через Telegram** - запуск рассылки по кнопке
- ✅ **Автоматическая авторизация** на CIAN
- ✅ **Применение фильтров**: "От собственника" + "Без долей"
- ✅ **4 варианта текста** - случайный выбор для уникальности
- ✅ **Без дублей** - сохраняет ID обработанных объявлений
- ✅ **Защита от капчи** - медленная скорость (~140 сообщ/час)
- ✅ **Мониторинг в реальном времени** - отчеты в Telegram
- ✅ **Антидетект браузер** - Puppeteer Stealth

---

## 📋 Команды Telegram бота

- **▶️ Запустить рассылку** - Начать работу
- **⏹️ Остановить рассылку** - Остановить бота
- **📊 Статистика** - Количество обработанных объявлений
- **⚙️ Настройки** - Текущая конфигурация
- **ℹ️ Помощь** - Справка

---

## 📁 Структура проекта

```
telegram-bot.js      # Главный файл - Telegram бот
cian-mailer.js       # Автоматизация CIAN
test-cian.js         # Тестовый скрипт
package.json         # Зависимости Node.js
config.env           # Настройки
env.example          # Пример конфигурации
processed_ads.txt    # База обработанных объявлений (создается автоматически)
README.md            # Главная документация
README_RU.md         # Полная документация на русском
QUICKSTART_RU.md     # Быстрый старт
INSTALL_RU.md        # Детальная установка
```

---

## ⚙️ Настройки

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| `MAX_PAGES` | Количество страниц | 5 |
| `MAX_PER_PAGE` | Объявлений на странице | 10 |
| `MIN_PAUSE` | Мин. пауза между объявлениями (сек) | 15 |
| `MAX_PAUSE` | Макс. пауза между объявлениями (сек) | 25 |

**Скорость:** ~140 сообщений/час (защита от капчи)

---

## ⚠️ Важно

- ❗ Бот **НЕ отправляет** сообщения - только **вводит текст**
- ❗ Можно останавливать/запускать - продолжит с места остановки
- ❗ При капче - пропускает объявление и продолжает
- ❗ Все ID сохраняются в `processed_ads.txt`

---

## 🐛 Решение проблем

### Бот не запускается
```bash
rm -rf node_modules package-lock.json
npm install
```

### Ошибка авторизации CIAN
- Проверьте email/пароль в `.env`
- Попробуйте войти вручную на cian.ru

### Бот не отвечает в Telegram
- Проверьте `TELEGRAM_BOT_TOKEN` в `.env`
- Проверьте `TELEGRAM_ADMIN_ID` (получите через [@userinfobot](https://t.me/userinfobot))

---

## 📖 Полная документация

- **[README_RU.md](./README_RU.md)** - Подробная документация на русском
- **[INSTALL_RU.md](./INSTALL_RU.md)** - Пошаговая инструкция по установке

---

## 🔄 Миграция с Python

Если использовали старую Python версию:
1. ✅ Файл `processed_ads.txt` совместим - все обработанные объявления сохранятся
2. ✅ Настройки из `config.env` работают напрямую (или скопируйте в `.env`)
3. ✅ Старые Python файлы уже удалены

---

## 📝 Лицензия

MIT

---

## 📜 Эпиграф

> *Движенья нет, сказал мудрец брадатый.*  
> *Другой смолчал и стал пред ним ходить.*  
> *Сильнее бы не мог он возразить;*  
> *Хвалили все ответ замысловатый.*  
> 
> — А.С. Пушкин, "Движение" (1825)

---

**Удачной рассылки! 🚀**
